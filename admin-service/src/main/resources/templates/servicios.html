<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Servicios | ADM</title>
    <style>
        .headers {
            height: 55px;
        }

        .servicios_container {
            display: flex;
            height: calc(100vh - 55px);
            overflow: hidden;
        }

        /*============
        ASIDE SERVICIOS 
        ==============*/
        aside.aside_servicios {
            width: 700px;
            background-color: var(--color-white-uno);
            padding: 20px;
            height: auto;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 10px;
            border-radius: 10px;
        }

        aside .header_aside_servicios {
            display: flex;
            width: 100%;
            justify-content: space-between;
            align-items: center;
        }

        /* ====== 
        BUSCADOR 
        ====== */
        .buscador_servicios {
            display: flex;
        }

        .buscador_servicios input {
            flex: 1;
            padding: 8px;
            border-radius: 6px 0 0 6px;
            border: 1px solid #ccc;
            outline: none;
        }

        .buscador_servicios button {
            padding: 8px 12px;
            border: none;
            border-radius: 0 6px 6px 0;
            background: var(--color-morado-suave);
            color: #fff;
            cursor: pointer;
        }

        /* ====== 
        ESTILO DE TABLA
         ====== */
        .lista_servicios {
            width: 100%;
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            background: #fff;
        }

        .lista_servicios table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
        }

        .tabla_servicios table th {
            font-size: 16px;
        }

        .tabla_servicios table td {
            font-size: 14px;
        }

        .lista_servicios th,
        .lista_servicios td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .lista_servicios th {
            background: var(--color-white-tres);
            font-weight: bold;
        }

        .lista_servicios tbody tr:nth-child(even) {
            background: #fafafa;
        }

        .lista_servicios tbody tr:hover {
            background: rgba(76, 175, 80, 0.05);
        }

        .col-id {
            width: 5%;
        }

        .col-servicio {
            width: 20%;
        }

        .col-precio {
            width: 10%;
        }

        .col-categoria {
            width: 15%;
        }

        .col-empleado {
            width: 15%;
        }

        .col-acciones {
            width: 35%;
        }

        /* ========
        EMPLEADO 
        ========== */
        .empleado_link {
            color: var(--color-morado-fuerte);
            font-weight: bold;
            text-decoration: none;
        }

        .empleado_link:hover {
            text-decoration: underline;
        }

        /* ======== 
        ACCIONES 
        ========== */
        .acciones {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .acciones button {
            padding: 6px 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.3s;
            color: #000;
        }

        .acciones button:hover {
            opacity: 0.85;
        }

        .acciones button a {
            text-decoration: none;
            color: #000;
        }

        .acciones .clientes {
            background: #f0f0f0;
        }

        .acciones .modificar {
            background: #4CAF50;
        }

        .acciones .suspender {
            background: #FF9800;
        }

        .acciones .ocultar {
            background: #607D8B;
        }

        .acciones .eliminar {
            background: #E53935;
        }

        /* ========
         CATEGOR√çAS 
         ====== */
        .categoria {
            padding: 4px 10px;
            border-radius: 8px;
            font-weight: bold;
            display: inline-block;
            font-size: 13px;
            border: 2px solid transparent;
        }

        .categoria.soporte {
            border-color: #2196F3;
            color: #2196F3;
            background: rgba(33, 150, 243, 0.1);
        }

        .categoria.consultoria {
            border-color: #4CAF50;
            color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }

        .categoria.mantenimiento {
            border-color: #FF9800;
            color: #FF9800;
            background: rgba(255, 152, 0, 0.1);
        }

        .categoria.seguridad {
            border-color: #E53935;
            color: #E53935;
            background: rgba(229, 57, 53, 0.1);
        }

        /*========== SECTION SERVICIOS ==========*/
        section.section_servicios {
            background-color: var(--color-white-tres);
            flex: 1;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
            margin: 10px;
            border-radius: 10px;
        }
    </style>

    <link rel="stylesheet" href="/css/styleAdmin.css">
</head>

<body>
    <!-- Componenetes Header -->
    <header th:replace="components/menu_admin" class="headers"></header>

    <div class="servicios_container">
        <aside class="aside_servicios">

            <div class="header_aside_servicios">
                <h2>Servicios</h2>
                <!-- Buscador -->
                <form action="/servicios" method="get">
                    <div class="buscador_servicios">
                        <input class="cabin" type="text" name="search" placeholder="Buscar servicio..." />
                        <button type="submit">üîç</button>
                    </div>
                </form>
                
            </div>

            <!-- Lista de Servicios -->
            <div class="lista_servicios">
                <table>
                    <thead>
                        <tr class="league-spartan">
                            <th class="col-id">#</th>
                            <th class="col-servicio">Servicio</th>
                            <th class="col-precio">Precio</th>
                            <th class="col-categoria">Categor√≠a</th>
                            <th class="col-empleado">Empleado</th>
                            <th class="col-acciones">Acciones</th>
                        </tr>
                    </thead>

                    <tbody class="cabin">
                        <tr th:each="s : ${servicios}">
                            <td th:text="${s.servicioId}">#001</td>
                            <td th:text="${s.nomb_Servicio}">Soporte T√©cnico</td>
                            <td th:text="'S/.'+${s.precio_Servicio}">$150</td>
                            <td>
                                <span th:class="'categoria ' + ${s.categoria.NombreCategoria}"
                                    th:text="${s.categoria.NombreCategoria}">
                                    Soporte
                                </span>
                            </td>
                            <td>
                                <a th:href="@{'/usuarios/usuario/Trabajador/' + ${s.empleado.id}}" class="empleado_link"
                                    th:text="${s.empleado.nombre} + ' ' + ${s.empleado.apellido}">
                                    Juan P√©rez
                                </a>
                            </td>
                            <td class="acciones">
                                <button class="clientes cabin">
                                    <a th:href="@{'/servicios/' + ${s.servicioId} + '/clientes'}">Clientes</a>
                                </button>
                                <button class="suspender cabin">Suspender</button>
                                <button class="eliminar cabin">Eliminar</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </aside>

        <section class="section_servicios">
            <!--CLIENTES: Mostramos los clientes que solicitaron el servicio-->
            <div th:if="${activePage == 'servicio_cliente'}">
                <div th:replace="components/servicio_cliente"></div>
            </div>

        </section>
    </div>
</body>

</html>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const colorBank = [
            { border: "#2196F3", bg: "rgba(33, 150, 243, 0.1)" },
            { border: "#4CAF50", bg: "rgba(76, 175, 80, 0.1)" },
            { border: "#FF9800", bg: "rgba(255, 152, 0, 0.1)" },
            { border: "#E53935", bg: "rgba(229, 57, 53, 0.1)" },
            { border: "#9C27B0", bg: "rgba(156, 39, 176, 0.1)" },
            { border: "#009688", bg: "rgba(0, 150, 136, 0.1)" },
            { border: "#795548", bg: "rgba(121, 85, 72, 0.1)" }
        ];

        const assignedColors = {};
        let colorIndex = 0;

        document.querySelectorAll(".categoria").forEach(span => {
            const catName = span.textContent.trim().toLowerCase();

            if (!assignedColors[catName]) {
                assignedColors[catName] = colorBank[colorIndex % colorBank.length];
                colorIndex++;
            }

            const color = assignedColors[catName];
            span.style.borderColor = color.border;
            span.style.color = color.border;
            span.style.backgroundColor = color.bg;
        });
    });
</script>